<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../d2l-icons/tier3-icons.html">
<link rel="import" href="../d2l-media-behavior/d2l-media-behavior.html">

<dom-module id="d2l-waveform">
	<template>
		<style>
			:host {
				position: relative;
			}

		</style>

		<canvas height="{{height}}" width="{{width}}" id="waveform"></canvas>
	</template>

	<script>
		Polymer({
			is: 'd2l-waveform',

			properties: {
				heightRatios: {
					type: Array,
					value: [
						.25, .50, .58, .75, .70, .55, 1.0, .83, .93, .90,
						.67, .95, .83, .80, .83, .75, .55, .45, .45, .50,
						.53, .48, .45, .38, .40, .40, .40, .40, .40, .45,
						.63, .63, .67, .55, .53, .58, .34, .35, .31, .80,
						.75, .74, .72, .69, .75, .76, .79, .75, .73, .75,
						.73, .74, .70, .67, .67, .75, .70, .73, .71, .60,
						.51, .15, .38, .40, .93, .85, .83, .81, .80, .78,
						.73, .74, .73, .75, .80, .90, .90, .80, .35, .33,
						.45, .48, .45, .28, .35, .38, .28, .30, .30, .30
					],
					notify: true
				},
				height: {
					type: Number,
					value: 30
				},
				lineWidth: {
					type: Number,
					value: 2
				},
				lineSpacing: {
					type: Number,
					value: 1
				},
				color: {
					type: String,
					value: '#D3D9E3'
				}
			},

			_drawWaveformLine: function(x, heightRatio) {
				var context = this.context;
				context.beginPath();
				context.moveTo(x, this.height);
				context.lineTo(x, this.height - (heightRatio * this.height));
				context.lineWidth = this.lineWidth;
				context.strokeStyle = this.color;
				context.lineCap = 'round';
				context.stroke();
				context.closePath();
			},

			ready: function() {
				var self = this;
				var heightRatios = this.heightRatios;
				this.width = heightRatios.length * (this.lineWidth + this.lineSpacing);

				var canvas = this.$.waveform;
				this.context = canvas.getContext('2d');

				var x = this.lineSpacing;
				heightRatios.forEach(function(h) {
					self._drawWaveformLine(x, h);
					x += self.lineWidth + self.lineSpacing;
				});
			}
		});

	</script>
</dom-module>
